# Vulnerability Management Lab

![Screenshot (66)](https://github.com/user-attachments/assets/b6819aab-1039-4b94-a132-b8d7c7c9bae4)

# Introduction

# Prepare Vulnerability Management Server
- In the Azure Marketplace, I selected to create a pre-configured VM running OpenVAS
  - VM Name: OpenVAS
  - Resource Group: Vulnerability-Management
  - Noted the VNet as it will be important for the server and client to be in the same network
- After the VM deployed, I SSH into the machine with PowerShell and waited for the installation
- Once completed, I was provided a URL and login credentials to use to access the web app through the browser

![Screenshot (46)](https://github.com/user-attachments/assets/9d4c1674-1160-442c-a846-272b17640b59)

# Create Client VM and Make it Vulnerable
- Created a Windows 10 VM to act as the client
  - Name: Win10-Vulnerable
  - Resource Group: Vulnerability-Management
  - VNet: Same as OpenVAS server
- After the VM deployed, I RDP into the machine
- Once logged in, I disbaled the Windows firewall and downloaded some old software to make the machine vulnerable
  - Old Version of FireFox: Firefox Setup 97.0b5
  - Old Version of VLC Player: vlc-1.1.7-win32
  - Old Version of Adobe Reader: 10.0_AdbeRdr1000_en_US_1_
 
  ![Screenshot (54)](https://github.com/user-attachments/assets/164812c3-6870-4028-9094-2382c2437c13)

# Configure OpenVAS to Perform Unauthenticated Scan
- Logged into the OpenVAS web app and created a New Host
  - The client VM's Private IP address was used to avoid running the scan over the internet

![Screenshot (47)](https://github.com/user-attachments/assets/c64f4f18-5cb0-4ed7-827b-9cffa5609d92)

- Created a new Target from the host and named it "Azure Vulnerable VM"

![Screenshot (48)](https://github.com/user-attachments/assets/1761db37-9761-4b1e-9d61-5c00c00025f7)

- Created a new task named "Scan - Azure Vulnerable VM" and set the scan target as "Azure Vulnerable VM" (Client VM)

![Screenshot (49)](https://github.com/user-attachments/assets/df2d7e33-6b30-47ee-a8b7-d1c6a203b776)

- Ran the scan and observed the results
  - Note that the old software that was downloaded on the client VM doesn't appear since this is an unauthenticated scan, which only gives a public view of the system

![Screenshot (53)](https://github.com/user-attachments/assets/b38f9dd0-8c6a-4f43-b3c3-64c557ce7e38)

# Configure Client VM for Credentialed Scan
- Disbaled User Account Control
  - This is to avoid the scanner from being blocked by the system when trying to access certain resources

![Screenshot (55)](https://github.com/user-attachments/assets/6c30b538-eb47-4c8e-8e83-07ce81111474)

- Enabled Remote Registry
  - This allows the scanner to connect to the registry

![Screenshot (56)](https://github.com/user-attachments/assets/d5bcbe8f-367b-4211-8a97-0b2485fef95a)

- Set Registry Key to allow local accounts to have full access
  - HKEY_LOCAL_MACHINE hive
  - SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System
  - Create a new DWORD (32-bit) value named LocalAccountTokenFilterPolicy and set the value to 1

![Screenshot (57)](https://github.com/user-attachments/assets/ab5e2256-ca2a-4173-963b-32980dac321b)

# Configure OpenVAS to perform Credentialed Scan
- Added New Credentials and saved them as "Azure VM Credentials"
  - This allows the scanner to log into the client VM to do a more thorough scan 
- Created a new Target named "Azure Vulnerable VM - Credentialed Scan"
  - Add the "Azure VM Credentials" in the SMB protocol slot
   
# Execute Credentialed Scan
- Created a new Task named "Scan - Azure Vulnerable VM - Credentialed"
  - Set the Target as "Azure Vulnerable VM - Credentialed Scan"
- Ran the scan and observed the results
  - Notice now there is a plethora of new vulnerabilites pertaining to the old software that was downloaded on the client VM
 
![Screenshot (62)](https://github.com/user-attachments/assets/982e2b39-5e19-4e7f-98d3-a12f0dc2d9d2)

# Remediate Vulnerabilities
- To remediate the vulnerabilites, I simply deleted the old software off of the client VM, and re-initiated the "Scan - Azure Vulnerable VM - Credentialed" scan to show it was successful.

![Screenshot (64)](https://github.com/user-attachments/assets/bdb9b879-8cde-44e4-b07a-c4360db13382)

# Conclusion
